# WCS Sandbox instance creation

**UC ID**: UC0001

**Description**: As a developer, I need to set up a sandbox instance in Weaviate Cloud Services (WCS) to prototype, test, and develop applications without impacting production data. This allows me to experiment with Weaviate's features, schemas, and queries in an isolated environment before deploying to the live system.

## Test Suite
**ID**: TS001_UC001

### Test Cases

### TC001-TS001-UC001: Sandbox instance creation without authentication

**Test Type**: Functional(Positive)

**Test Description**: Verify that a user with a valid WCS account is able to create a WCS sandbox instance successfully. The instance will be created without authentication. After it's creation, it must be possible to delete the instance. Verifying that all resources were properly cleaned up.

**Test preparation**:

* 1. Create a WCS account to be able to login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name, for example: test-sandbox.
* 4. Click on <kbd>Enable Authentication?</kbd> and set it to NO.
* 5. Click on <kbd>Create</kbd>.
* 6. Wait for the WCS sandbox instance to be created.

**Test run**:
* 7. Retrieve cluster details and verify that the WCS sandbox instance is up and running.
* 8. Trigger sanity checks against the sandbox instance:
  * 8\.1. Ensure that the cluster endpoint is reachable.
  * 8\.2. Ensure that no authentication is needed to access the WCS instance.
  * 8\.3. Create a class, add a set of objects in batches to the sandbox instance.
  * 8\.4. Ensure that the stored objects can be queried.
  * 8\.5. Remove some of the added objects and ensure that they aren't present anymore in the instance.
  * 8\.6. Check that the displayed version from the instance details matches the service's version.
  * 8\.7. Check that all the modules displayed in the instance details are really available in the instance.

**Test cleanup**:
* 9. From the [WCS dashboard](https://console.weaviate.cloud/dashboard) allocate the created *test-sandbox* sandbox instance and click on the rubbish bin for deletion.
* 10. Write the instance's name in the text box and click confirm.
* 11. Wait for the WCS sandbox instance to be destroyed.
* 12. Verify that the sandbox instance was properly cleaned up:
  * 12\.1. Make sure that the endpoint is not reachable.
  * 12\.2. Check that the instance isn't running in the cloud provider anymore and no storage volumes or containers are left.
  * 12\.3. Confirm that all associated resources are properly cleaned up, preventing unnecessary costs.

### TC002-TS001-UC001: Sandbox instance creation with authentication

**Test Type**: Functional(Positive)

**Test Description**: Verify that a user with a valid WCS account is able to create a WCS sandbox instance successfully. The instance will be created with authentication. After it's creation, it must be possible to delete the instance. Verifying that all resources were properly cleaned up.

**Test preparation**:

* 1. Create a WCS account to be able to login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name, for example: test-sandbox.
* 4. Make sure that <kbd>Enable Authentication?</kbd> is set to YES.
* 5. Click on <kbd>Create</kbd>.
* 6. Wait for the WCS sandbox instance to be created.

**Test run**:
* 7. Retrieve cluster details and verify that the WCS sandbox instance is up and running.
* 8. Trigger sanity checks against the sandbox instance:
  * 8\.1. Ensure that the cluster endpoint is reachable.
  * 8\.2. Ensure that the instance is not accessible if the admin API key is not passed.
  * 8\.3. Verify that the instance is accessible when passing the admin API key.
  * 8\.4. Confirm that the instance is accessible when passing the username and password during authentication.
  * 8\.5. Create a class, add a set of objects in batches to the sandbox instance.
  * 8\.6. Ensure that the stored objects can be queried.
  * 8\.7. Remove some of the added objects and ensure that they aren't present anymore in the instance.
  * 8\.8. Check that the displayed version from the instance details matches the service's version.
  * 8\.9. Check that all the modules displayed in the instance details are really available in the instance.

**Test cleanup**:
* 9. From the [WCS dashboard](https://console.weaviate.cloud/dashboard) allocate the created *test-sandbox* sandbox instance and click on the rubbish bin for deletion.
* 10. Write the instance's name in the text box and click confirm.
* 11. Wait for the WCS sandbox instance to be destroyed.
* 12. Verify that the sandbox instance was properly cleaned up:
  * 12\.1. Make sure that the endpoint is not reachable.
  * 12\.2. Check that the instance isn't running in the cloud provider anymore and no storage volumes or containers are left.
  * 12\.3. Confirm that all associated resources are properly cleaned up, preventing unnecessary costs.

### TC003-TS001-UC001: Sandbox instance creation with very long instance name and deleted by expiration

**Test Type**: Functional(Positive)

**Test Description**: Verify that a user with a valid WCS account is able to create a WCS sandbox instance successfully when passing an instance name with 32 characters. The instance will be created without authentication. After it's creation, the test case must force the expiration of the sandbox instance.

**Test preparation**:

* 1. Create a WCS account to be able to login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name with 32 characters, for example: *this-is-a-very-long-clustername*.
* 4. Make sure that <kbd>Enable Authentication?</kbd> is set to NO.
* 5. Click on <kbd>Create</kbd>.
* 6. Wait for the WCS sandbox instance to be created.

**Test run**:
* 7. Retrieve cluster details and verify that the WCS sandbox instance is up and running.
* 8. Trigger sanity checks against the sandbox instance:
  * 8\.1. Ensure that the cluster endpoint is reachable.
  * 8\.2. Ensure that no authentication is needed to access the WCS instance.
  * 8\.3. Create a class, add a set of objects in batches to the sandbox instance.
  * 8\.4. Ensure that the stored objects can be queried.
  * 8\.5. Remove some of the added objects and ensure that they aren't present anymore in the instance.
  * 8\.6. Check that the displayed version from the instance details matches the service's version.
  * 8\.7. Check that all the modules displayed in the instance details are really available in the instance.

**Test cleanup**:
* 9. Force the instance's expiration date to match the current timestamp + 120 seconds.
* 10. Verify that the expiration date displayed in the instance details matches the new set date.
* 11. Wait for the WCS sandbox instance to be destroyed.
* 12. Verify that the sandbox instance was properly cleaned up:
  * 12\.1. Make sure that the endpoint is not reachable.
  * 12\.2. Check that the instance isn't running in the cloud provider anymore and no storage volumes or containers are left.
  * 12\.3. Confirm that all associated resources are properly cleaned up, preventing unnecessary costs.

### TC004-TS001-UC001: Sandbox instance names with more than 32 characters are not accepted

**Test Type**: Functional(Negative)

**Test Description**: Verify that a user can't create a Sandbox instance using an instance name with more than 32 characters.

**Test run**:

* 1. Create a WCS account to be able to login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name with 33 characters, for example: *this-is-a-very-long-clusternames*.
* 4. Click on <kbd>Create</kbd>.
* 5. Verify that the error *Max 32 characters is allowed* is displayed and the instance isn't created.

### TC005-TS001-UC001: Sandbox instance name does not accept special characters

**Test Type**: Functional(Negative)

**Test Description**: Verify that a user can't create a Sandbox instance using an instance name with a special character on the name.

**Test run**:

* 1. Create a WCS account to be able to login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name with 33 characters, for example: *espa√±a*.
* 4. Click on <kbd>Create</kbd>.
* 6. Verify that the error *Invalid name, please only use lower case letters (a-z), digits (0-9) and the dash sign (-).* is displayed and the instance isn't created.

### TC006-TS001-UC001: Sandbox instance name can't be less than 2 characters

**Test Type**: Functional(Negative)

**Test Description**: Verify that a user can't create a Sandbox instance using an instance name with a less than two characters.

**Test run**:

* 1. Create a WCS account to be able to login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name with 33 characters, for example: *w*.
* 4. Click on <kbd>Create</kbd>.
* 5. Verify that the error *Min 2 characters is required* is displayed and the instance isn't created.

### TC007-TS001-UC001: Simulating concurrent development activities

**Test Type**: Performance

**Test Description**: Sandbox instances are able to handle multiple connections from several clients which are performing different types of development activities concurrently.

**Test preparation**:

* 1. Login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful.
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name, for example: test-sandbox.
* 4. Make sure that <kbd>Enable Authentication?</kbd> is set to YES.
* 5. Click on <kbd>Create</kbd>.
* 6. Wait for the WCS sandbox instance to be created.

**Test run**:
* 7. Retrieve cluster details and verify that the WCS sandbox instance is up and running.
* 8. Simulate a scenario where three developers are actively using the sandbox instance:
  * 8\.1. Process 1: Authenticates using the API key and starts creating several schemas and updating them.
  * 8\.2. Process 2: Authenticates using the same API key and starts ingesting data.
  * 8\.3. Process 3: Authenticates using the same API key and performs several complex queries.
  * 8\.4. During the simulation time store: response time, throughput (API requests per second), concurrency level (number of simultaneous connections), sandbox instance resources (CPU, memory and disk usage).
* 9. Analyze the retrieved data looking for performance bottlenecks.

**Test cleanup**:
* 10. From the [WCS dashboard](https://console.weaviate.cloud/dashboard) allocate the created *test-sandbox* sandbox instance and click on the rubbish bin for deletion.
* 11. Write the instance's name in the text box and click confirm.
* 12. Wait for the WCS sandbox instance to be destroyed.
* 13. Verify that the sandbox instance was properly cleaned up:
  * 13\.1. Make sure that the endpoint is not reachable.
  * 13\.2. Check that the instance isn't running in the cloud provider anymore and no storage volumes or containers are left.
  * 13\.3. Confirm that all associated resources are properly cleaned up, preventing unnecessary costs.

### TC008-TS001-UC001: Accessing Sandbox API endpoints without authorization

**Test Type**: Security

**Test Description**: Attempt the creation, deletion and querying of data objects in a Sandbox instance configured with authentication by accessing the API endpoints directly without any authentication.

**Test preparation**:

* 1. Login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful.
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name, for example: test-sandbox.
* 4. Make sure that <kbd>Enable Authentication?</kbd> is set to YES.
* 5. Click on <kbd>Create</kbd>.
* 6. Wait for the WCS sandbox instance to be created.
* 7. Create an schema and add objects into the Sandbox instance.

**Test run**:
* 8. Retrieve cluster details and verify that the WCS sandbox instance is up and running.
* 9. Attempt the following scenarios by accessing directly the [API endpoints](https://weaviate.io/developers/weaviate/api/rest) without any authentication:
  * 9\.1. [List data objects](https://weaviate.io/developers/weaviate/api/rest/objects#list-data-objects) without authentication. Ensure that the request fails and no data is retrieved.
  * 9\.2. [Create data objects](https://weaviate.io/developers/weaviate/api/rest/objects#create-a-data-object) without authentication. Ensure that the request fails and no data is stored in the Sandbox instance.
  * 9\.3. [Update data objects](https://weaviate.io/developers/weaviate/api/rest/objects#update-a-data-object) without authentication. Ensure that the request fails and no data is retrieved.
  * 9\.4. [Delete data objects](https://weaviate.io/developers/weaviate/api/rest/objects#delete-a-data-object) without authentication. Ensure that the request fails and no data is retrieved.


**Test cleanup**:
* 10. From the [WCS dashboard](https://console.weaviate.cloud/dashboard) allocate the created *test-sandbox* sandbox instance and click on the rubbish bin for deletion.
* 11. Write the instance's name in the text box and click confirm.
* 12. Wait for the WCS sandbox instance to be destroyed.
* 13. Verify that the sandbox instance was properly cleaned up:
  * 13\.1. Make sure that the endpoint is not reachable.
  * 13\.2. Check that the instance isn't running in the cloud provider anymore and no storage volumes or containers are left.
  * 13\.3. Confirm that all associated resources are properly cleaned up, preventing unnecessary costs.

### TC009-TS001-UC001: Vulnerability scanning of a Sandbox Instance

**Test Type**: Security

**Test Description**: Perform a vulnerability scanning of the Sandbox instance endpoints.

**Test preparation**:

* 1. Login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful.
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name, for example: test-sandbox.
* 4. Make sure that <kbd>Enable Authentication?</kbd> is set to YES.
* 5. Click on <kbd>Create</kbd>.
* 6. Wait for the WCS sandbox instance to be created.
* 7. Create an schema and add objects into the Sandbox instance.

**Test run**:
* 8. Retrieve cluster details and verify that the WCS sandbox instance is up and running.
* 9. Configure vulnerability scanning tool using the retrieved cluster information
* 10. Run the vulnerability scanning tool. Fail if any vulnerability over a determined level (CRITICAL) is found.

**Test cleanup**:
* 11. From the [WCS dashboard](https://console.weaviate.cloud/dashboard) allocate the created *test-sandbox* sandbox instance and click on the rubbish bin for deletion.
* 12. Write the instance's name in the text box and click confirm.
* 13. Wait for the WCS sandbox instance to be destroyed.
* 14. Verify that the sandbox instance was properly cleaned up:
  * 14\.1. Make sure that the endpoint is not reachable.
  * 14\.2. Check that the instance isn't running in the cloud provider anymore and no storage volumes or containers are left.
  * 14\.3. Confirm that all associated resources are properly cleaned up, preventing unnecessary costs.

### TC010-TS001-UC001: Authentication data not exposed in Sandbox logs

**Test Type**: Security

**Test Description**: Verifies that when authenticating any client to a Sandbox instance, either using API token or user/password method, the authentication information isn't stored on the logs.

**Test preparation**:

* 1. Login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful.
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name, for example: test-sandbox.
* 4. Make sure that <kbd>Enable Authentication?</kbd> is set to YES.
* 5. Click on <kbd>Create</kbd>.
* 6. Wait for the WCS sandbox instance to be created.

**Test run**:
* 7. Retrieve cluster details and verify that the WCS sandbox instance is up and running.
* 8. Authenticate two clients to the Sandbox instance, one using API token and the other user/password.
* 9. Retrieve the Sandbox instance logs and ensure that neither the API token, nor the authentication details (user or password) are present in the logs.

**Test cleanup**:
* 10. From the [WCS dashboard](https://console.weaviate.cloud/dashboard) allocate the created *test-sandbox* sandbox instance and click on the rubbish bin for deletion.
* 11. Write the instance's name in the text box and click confirm.
* 12. Wait for the WCS sandbox instance to be destroyed.
* 13. Verify that the sandbox instance was properly cleaned up:
  * 13\.1. Make sure that the endpoint is not reachable.
  * 13\.2. Check that the instance isn't running in the cloud provider anymore and no storage volumes or containers are left.
  * 13\.3. Confirm that all associated resources are properly cleaned up, preventing unnecessary costs.

### TC011-TS001-UC001: Sandbox Instance port scanning

**Test Type**: Security

**Test Description**: Perform a network port scanning of the Sandbox instance to make sure that no more ports or services than the strictly required are exposed.

**Test preparation**:

* 1. Login into the [WCS dashboard](https://console.weaviate.cloud/dashboard). Make sure that the login was successful.
* 2. Click in <kbd>+Create cluster</kbd> and make sure to select the <kbd>Free sandbox</kbd> tab.
* 3. Add a cluster name, for example: test-sandbox.
* 4. Make sure that <kbd>Enable Authentication?</kbd> is set to YES.
* 5. Click on <kbd>Create</kbd>.
* 6. Wait for the WCS sandbox instance to be created.
* 7. Create an schema and add objects into the Sandbox instance.

**Test run**:
* 8. Retrieve cluster details and verify that the WCS sandbox instance is up and running.
* 9. Configure nmap scanning tool using the retrieved cluster information
* 10. Run the nmap port scanning tool. Fail if any port or service than the strictly required are exposed.

**Test cleanup**:
* 11. From the [WCS dashboard](https://console.weaviate.cloud/dashboard) allocate the created *test-sandbox* sandbox instance and click on the rubbish bin for deletion.
* 12. Write the instance's name in the text box and click confirm.
* 13. Wait for the WCS sandbox instance to be destroyed.
* 14. Verify that the sandbox instance was properly cleaned up:
  * 14\.1. Make sure that the endpoint is not reachable.
  * 14\.2. Check that the instance isn't running in the cloud provider anymore and no storage volumes or containers are left.
  * 14\.3. Confirm that all associated resources are properly cleaned up, preventing unnecessary costs.

## Review

* [ ] Reviewed by the development team
* [ ] Reviewed by QE peers
